<!DOCTYPE html>
<html>

<head>

	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">

	<style type="text/css">
  
		.header {
			font-size: 20pt;
			font-weight: bold;
		}
	
		.subheader {
			font-size: 17pt;
			font-weight: bold;
		}
  
		.caption {
			font-size: 14pt;
			font-weight: bold;
		}
  
		.section {
			font-size: 12pt;
			font-weight: bold;
		}
  
		.bold {
			font-weight: bold;
		}
  
		.italic {
			font-style: italic;
		}
  
		.code {
			font-family: "Courier New";
            font-size: small;
		}

        .snippet {
            font-family: "Courier New";
            font-size: small;
            margin-left: 50px;
        }

        .warning {
            font-weight: bold;
            color: red;
        }

	</style>

</head>

<body>

<span class="header"> 1.	JAVA </span> <br /><br />
<span class="subheader"> 1.1.	Apache Axis2 </span> <br /><br />

<p>
    Apache Axis2 is a Java framework for working with WebServices, SOAP and WSDL. It provides means to create, send, receive and handle
    SOAP messages to and from web services. <br />
    Axis2 Engine has two main functionalities:
    <ul>
        <li>Providing services as a web services server</li>
        <li>Consuimng services from server as a web services client</li>
    </ul>

    The use of both is similar - one should provide Axis2 with web services description in form of WSDL files,
    and it will produce corresponding java code. When generating clients, the framework will produce service stubs.
    Generated stubs will contain two major components:

    <ul>
        <li>Static inner classes for each complex type defined in corresponding XSD file (together with all nested classes,
        reflecting the hierarchy defined in schema) </li>
        <li>Methods to invoke web services calls (one method per each binding defined in WSDL file) </li>
    </ul>

    When generating services stubs, Axis2 will take a WSDL file (with all related XSD files) and respond with appropriate
    structure of directories and classes. The next step is to fill generated classes' methods with business-logic code to provide
    desired functionality for services. Among generated files there will be a Ant <span class="code" >build.xml</span> file. When invoked on that
    file, Ant will compile all sources and pack them into a WAR archive, ready to deploy into a web server, such as Tomcat.

</p>

<span class="bold">Using Axis2</span>

<p>
    Axis2 may be used either as stand-alone command line tool or as a Maven plugin. When using Axis2 from command line,
    user must specify <span class="code">AXIS2_HOME</span> home variable, pointing to the location of Axis2 directory.
    Appending <span class="code">$AXIS2_HOME/bin</span> (or <span class="code">%AXIS2_HOME%\bin</span> under Windows)
    to <span class="code">PATH</span> system variable will allow to run Axis2-related scripts easily. <br /><br />
    Using Axis2 as Maven dependency will be no surprise for Maven users. For information about versioning and
    dependencies, see <a href="http://mvnrepository.com/artifact/org.apache.axis2" >Maven repository site</a>.
</p>

<span class="section">Typical Axis2 flow (client)</span>

<p>
    Consuming web services with Axis2 contains of the following steps:

    <ol>
        <li>Collecting all necessary files (WSDL, XML and XSD) for each service</li>
        <li>Generating services stubs code, using one of the data binding frameworks (e.g. ADB, XMLBeans, JiBX)</li>
        <li>Creating client, which will use services stubs</li>
        <li>Providing handlers for messages (this is described below)</li>
        <li>Invoking services via adequate methods calls</li>
        <li>Receiving and handling the response</li>
    </ol>
</p>

<p>
    Client generation is accomplished through invoking <span class="code">wsdl2java</span> tool. <br /><br />

    <span class="code">wsdl2java</span> may be accessed in various ways:
<ul>
    <li>As stand-alone command line tool</li>
    <li>As Ant task</li>
    <li>As maven plugin</li>
</ul>

<p> Usage of all of the above is similar. It requires specifying location of the WSDL and XML Schema files, output location for
    the generated sources and package name for generated classes. Unless told differently, ADB generates one big stub class
    per one web service definition (or, alternatively, one stub java class per one WSDL file). Parameters are passed as
    command line options when running from command line. In case of invoking via Ant or Maven tool they are specified in adequate
    XML file (build.xml or pom.xml). <br /><br />

    Generating clients via command line tool is done by executing the following script: <br /><br/>

    <span class="code">
        $AXIS2_HOME/bin/wsdl2java.sh -uri &lt;path to .wsdl file&gt; -p &lt;output package name&gt; -d &lt;data binding framework&gt; -o &lt;output directory&gt; <br /><br />
    </span>
    The comman line tool is documented in detail <a href="http://axis.apache.org/axis2/java/core/docs/reference.html">HERE</a>.
<br /><br />



<br /><br/>
For the detailed parameters specification, see: </p>

<ul>
    <li> <a href="http://axis.apache.org/axis2/java/core/tools/CodegenToolReference.html">This</a> for command line and Ant </li>
    <li> <a href="http://axis.apache.org/axis2/java/core/tools/maven-plugins/maven-wsdl2code-plugin.html">This</a> for Maven plugin </li>
</ul>

</p>

<hr> <!-- TODO: enhance integrity of the content -->

<p>
    Handlers are classes that extend the <span class="code" >org.apache.axis2.handlers.AbstractHandler</span> class.
    A handler must extends that abstract class and implement
    <span class="code">public&nbsp;Handler.InvocationResponse&nbsp;invoke(MessageContext&nbsp;msgContext)&nbsp;throws&nbsp;AxisFault</span>
    method. Per each message in specified scope, this method will be invoked with the corresponding <span class="code">MessageContext</span>
    object as a parameter. <br /><br />
    There is a situation when specifying a handler is mandatory. It is when a message going in or out
    contains a <span class="code">mustUnderstand="1"</span> attribute value. Each such message must be handled the proper way,
    or <span class="code">org.apache.axis2.AxisFault</span> will be thrown. To avoid this and ensure correct
    <span class="code">mustUnderstand="1"</span> handling, the following step must be taken:
    <ul>
        <li>
            The <span class="code">setProcessed()</span> method must be invoked on each of the <span class="code">SOAPHeaderBlock</span>
            members of the <span class="code">SOAPHeader</span> element of the current context.
        </li>
    </ul> <br />
    The example flow may look something like this:

<p class="snippet">
    SOAPHeaderBlock header = msgContext.getEnvelopE().getHeader(); <br />
    Iterator headerBlocksIterator = header.getHeadersToProcess(null); <br /><br />
    while( headerBlocksIterator.hasNext() ) { <br />
    &emsp;&emsp;((SOAPHeaderBlock) headerBlocksIterator.next()).setProcessed();<br />
    }<br />
</p>

</p>

<span class="section">1.1.1.	ADB data binding </span> <br /><br />
<span class="bold"> Overwiev </span> <br /><br />

<p> ADB data binding framework is intended to be rather simple and lightweight. It provides means to compile XML schemas and WSDL files into java classes. 
Use of this tool is pretty straightforward, but working with generated files may be cumbersome. </p>

<span class="bold">Using ADB data binding </span> <br />
 
<p> ADB data binding is generally available through the <span class="code">WSDL2Java</span> tool, by specifying proper databinding option, as described
    in Axis2 section <!-- TODO: add link -->.

</p>
<span class="bold">Execution requirements</span>

<p> As Sabre Web Services definitions (provided in form of WSDL files) use corresponding types of data structures, proper XML Schema files must be provided in same location as the WSDL file. 
It includes common schemas for SOAP communication protocol (available as Common Schemas asset at <a href="https://drc.sabre.com/">https://drc.sabre.com/</a> ) and request/response object pairs definition 
(available also at <a href="https://drc.sabre.com/">https://drc.sabre.com/</a> as asset for each service). </p>

<span class="bold">Generated code</span>

<p> If all of the required files are available for code generation tool, after invocation it will by default generate one stub java class per service.
The file will be placed in proper folder structure, according to specified output package and directory. 
The file will be named <span class="code"> &lt;serviceName&gt;ServiceStub.java </span>
The stub will contain static inner classes for each complex type. Any element or attribute encapsulated by this complex type 
will become a field in that class. Simple types restrictions are handled by replacing the relevant type with the basetype. 
Generated classes follow the bean convention, with <span class="code">setAttribute</span> and <span class="code">getAttribute</span> methods for object fields and 
<span class="code">addElement(Element e)</span> or <span class="code">setElements(Element [] e)</span> for arrays.

    </p>

<span class="bold">Limitations and drawbacks</span> <span class="warning">(important)</span>
<p>
    Generated files may be quite large (up to hundreds of thousands of lines, depending on service definition complexity ) and therefore
    problematic to work with, for example some IDE settings changes may be necessary. <br />
    What is more, ADB does not handle optional attributes in schema definitions well. In generated SOAP messages optional
    attributes are always present, with values set to their defaults, which may not be desired behavior. In particular cases
    optional attributes may be mutually exclusive and sending request containing them to server may cause the server
    to respond with Fault message. <br />
    Therefore it might not be possible to use automatically generated code without modificating it manually. <br /><br />
    Because of the facts mentioned above, <span class="warning">ADB is not a recommended databinding framework
    for working with Sabre Web Services.</span>
</p>


</body>
</html>
